{"version":3,"sources":["/source/index.config.js"],"names":["angular","module","call","this","service","$log","$http","apiURL","publicPhotos","callback","jsonp","then","response","data","items","map","i","author","slice","description","replace","trim","tags","split","error","controller","Flickr","photos","loadDisabled","clearMode","_this","loadMore","_","uniq","concat","x","link","directive","conf","detectElement","imagesToLazyLoad","isLoading","loadImages","tolerance","element","css","forEach","key","image","isVisible","inViewport","Image","onload","background-image","src","parent","opacity","attr","splice","length","clearInterval","restrict","scope","attributes","push","setInterval","prototype","offsetWidth","offsetHeight","rect","getBoundingClientRect","top","left","bottom","window","innerHeight","document","documentElement","clientHeight","right","innerWidth","clientWidth","$window","$timeout","distance","disabled","elem","attrs","raw","bind","offsetTop","pageYOffset","run","config","$stateProvider","$urlRouterProvider","state","url","templateUrl","controllerAs","otherwise","$logProvider","debugEnabled","$templateCache","put"],"mappings":"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","file":"scripts/app-67d2a92769.js","sourcesContent":["(function() {\n  angular.module('flickrPhotoStream', ['ngTouch', 'ui.router', 'ngSanitize']);\n\n}).call(this);\n\n\n\n(function() {\n  angular.module('flickrPhotoStream').service('Flickr', function($log, $http) {\n    var apiURL;\n    apiURL = 'https://api.flickr.com/services/feeds/photos_public.gne?format=json&jsoncallback=JSON_CALLBACK';\n    this.publicPhotos = function(callback) {\n      return $http.jsonp(apiURL).then(function(response) {\n        response.data.items.map(function(i) {\n          i.author = i.author.slice(19, -1);\n          i.description = i.description.replace(/<p><.+?<\\/p>/g, '').trim().slice(3, -5);\n          i.tags = i.tags === \"\" ? [] : i.tags.split(' ');\n          return i;\n        });\n        return callback(response.data.items);\n      })[\"catch\"](function(error) {\n        return callback([]);\n      });\n    };\n  });\n\n}).call(this);\n\n\n\n(function() {\n  angular.module('flickrPhotoStream').controller('MainController', function(Flickr) {\n    this.photos = [];\n    this.loadDisabled = false;\n    this.clearMode = false;\n    Flickr.publicPhotos((function(_this) {\n      return function(photos) {\n        return _this.photos = photos;\n      };\n    })(this));\n    this.loadMore = (function(_this) {\n      return function() {\n        _this.loadDisabled = true;\n        return Flickr.publicPhotos(function(photos) {\n          _this.photos = _.uniq(_this.photos.concat(photos), function(x) {\n            return x.link;\n          });\n          return _this.loadDisabled = false;\n        });\n      };\n    })(this);\n  });\n\n}).call(this);\n\n\n\n(function() {\n  angular.module('flickrPhotoStream').directive('lazyBg', function() {\n    var conf, detectElement, imagesToLazyLoad, isLoading, loadImages;\n    conf = {\n      tolerance: 500,\n      detectElement: true\n    };\n    imagesToLazyLoad = [];\n    isLoading = null;\n    detectElement = function(element) {\n      if (!element.css('min-width') || element.css('min-width') === '0px') {\n        element.css('min-width', '1px');\n      }\n      if (!element.css('min-height') || element.css('min-height') === '0px') {\n        return element.css('min-height', '1px');\n      }\n    };\n    loadImages = function() {\n      angular.forEach(imagesToLazyLoad, function(element, key) {\n        var image;\n        if (element.isVisible() && element.inViewport(conf.tolerance)) {\n          image = new Image;\n          image.onload = function() {\n            element.css({\n              'background-image': \"url(\" + this.src + \")\"\n            });\n            return element.parent().css({\n              'opacity': 1\n            });\n          };\n          image.src = element.attr('lazy-bg');\n          return imagesToLazyLoad.splice(key, 1);\n        }\n      });\n      if (imagesToLazyLoad.length === 0) {\n        return clearInterval(isLoading);\n      }\n    };\n    return {\n      restrict: 'A',\n      link: function(scope, element, attributes) {\n        if (conf.detectElement) {\n          detectElement(element);\n        }\n        imagesToLazyLoad.push(element);\n        clearInterval(isLoading);\n        return isLoading = setInterval((function() {\n          return loadImages();\n        }), 50);\n      }\n    };\n  });\n\n  angular.element.prototype.isVisible = function() {\n    var element;\n    element = this[0];\n    return element.offsetWidth > 0 && element.offsetHeight > 0;\n  };\n\n  angular.element.prototype.inViewport = function(tolerance) {\n    var element, rect;\n    element = this[0];\n    rect = element.getBoundingClientRect();\n    return rect.top >= 0 - tolerance && rect.left >= 0 - tolerance && rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) + tolerance && rect.right <= (window.innerWidth || document.documentElement.clientWidth) + tolerance;\n  };\n\n}).call(this);\n\n\n\n(function() {\n  angular.module('flickrPhotoStream').directive('infiniteScroll', function($window, $timeout) {\n    return {\n      scope: {\n        callback: '&infiniteScroll',\n        distance: '=infiniteScrollDistance',\n        disabled: '=infiniteScrollDisabled'\n      },\n      link: function(scope, elem, attrs) {\n        var raw;\n        raw = elem[0];\n        return angular.element($window).bind('scroll', function() {\n          var distance;\n          distance = elem[0].offsetHeight + elem[0].offsetTop - $window.innerHeight - $window.pageYOffset;\n          if (!scope.disabled && distance <= $window.innerHeight) {\n            return $timeout(scope.callback);\n          }\n        });\n      }\n    };\n  });\n\n}).call(this);\n\n\n\n(function() {\n  angular.module('flickrPhotoStream').run(function() {});\n\n}).call(this);\n\n\n\n(function() {\n  angular.module('flickrPhotoStream').config(function($stateProvider, $urlRouterProvider) {\n    $stateProvider.state('main', {\n      url: '/',\n      templateUrl: 'app/pages/main.html',\n      controller: 'MainController',\n      controllerAs: 'main'\n    });\n    return $urlRouterProvider.otherwise('/');\n  });\n\n}).call(this);\n\n\n\n(function() {\n  angular.module('flickrPhotoStream');\n\n}).call(this);\n\n\n\n(function() {\n  angular.module('flickrPhotoStream').config(function($logProvider) {\n    return $logProvider.debugEnabled(true);\n  });\n\n}).call(this);\n\n\n\nangular.module(\"flickrPhotoStream\").run([\"$templateCache\", function($templateCache) {$templateCache.put(\"app/pages/main.html\",\"<div class=main><header><h1>Flickr Photo Stream</h1><nav><input type=search ng-model=search placeholder=Search... class=search> <button ng-click=\\\"main.clearMode = !main.clearMode\\\" ng-class=\\\"main.clearMode ? \\'clear\\' : \\'default\\'\\\" class=toggle></button></nav></header><section infinite-scroll=main.loadMore() infinite-scroll-disabled=main.loadDisabled ng-class=\\\"{clear: main.clearMode}\\\" class=photos><article ng-repeat=\\\"photo in main.photos | filter:search track by photo.link\\\" class=photo><div lazy-bg={{::photo.media.m}} class=image></div><div class=details><a ng-href={{::photo.link}} ng-bind-html=::photo.title class=title></a><p class=author>by <a ng-href=https://www.flickr.com/photos/{{::photo.author_id}}/ ng-bind=::photo.author></a></p><p ng-bind-html=::photo.description class=description></p><div class=tags><div ng-repeat=\\\"tag in ::photo.tags | limitTo: 3\\\" ng-bind=::tag class=tag></div><div ng-if=\\\"::photo.tags.length &gt; 3\\\" class=tag-more>+{{::photo.tags.length - 3}}</div></div></div></article></section></div>\");}]);"],"sourceRoot":"/source/"}